%%=============================================================================
%% Domain Events
%%=============================================================================

\section{Domain Events}
\label{sec:domain-events}

Domain events zijn een essentieel onderdeel van EventSourcing. Domain Events zijn, net als commands and queries, messages. Domain Events zijn de effectieve events die zullen opgeslagen worden in een append-only database. Een event is iets dat gebeurd is en nooit meer kan veranderen. Er zijn een paar belangrijke eigenschappen van deze events.

\begin{itemize}
  \item{Ze bevatten een unieke id, die op voorhand vastgelegd is. Dit kan een \gls{GUID} zijn.}
  \item{Ze bevatten enkel de data die gewijzigd is ten opzichte van de vorige versie.}
  \item{Alle data die ze bevatten, is correct en kan niet meer aangepast worden.}
\end{itemize}

Domain events worden opgeslagen in een append-only database, maar wat als er een fout gemaakt is? Indien een fout is opgetreden, moet er een nieuw domain event gemaakt worden, dat het vorige event corrigeert. Op deze manier blijft al de data correct, en gaat er geen belangrijke informatie verloren. Er is ook niet geprutst met de historiek van deze events, wat van belang is omdat de geschiedenis herschrijven gevolgen kan hebben voor een systeem. Het herschrijven van de geschiedenis houdt in dat de audit log (Hoofdstuk~\ref{sec:audit-log}) niet meer geldig is. Het houdt ook in dat elke projectie opnieuw zal moeten opgebouwd, omdat een wijziging in 1 event een totaal andere uitkomst kan creÃ«ren in de huidige state.

Domain events hebben ook een naam, deze naam is specifiek voor de use case. Het vertelt meer over wat er gebeurd is of wat er zal gebeuren. Het is ook aangeraden dat deze naam in de verleden tijd is opgesteld. Zo kan er gedifferentieerd worden tussen de soorten messages (Hoofdstuk~\ref{sec:messages}) en kan de leesbaarheid verhoogd worden naar andere partijen toe (developers, business). Een event is tenslotte gebeurd in het verleden. Als er in context van Skedify gesproken wordt, dan is AppointmentWasRescheduled een goede naam voor een domain event. Het is ook van belang dat er geen \gls{CRUD} events gemaakt worden zoals ``OfficeWasCreated'', want er werd niet effectief een office gemaakt in het echte leven. Er is echter een office, die in het echt bestaat, aan de applicatie toegevoegd. ``OfficeWasAdded'' zou dus een betere naam zijn.
